
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>presentation_time</title>

    <link rel="stylesheet" href="&#x2f;wayland-protocol-docs/main.css">
     
  </head>
  <body class="black-70 flex sans-serif ph4-l">
    <div id="sidebar" class="w-20">
      <div class="fixed vh-100 overflow-y-auto w-20">
        <a href="&#x2f;wayland-protocol-docs/" class="f4 link near-black dim lh-title db mt3">
          Home
        </a>
        
  <div class="ph2">
    

<div>
  <ul class="list pl0">
  
    <li>
      <a href="#i:wp_presentation" class="link blue underline-hover lh-copy">wp_presentation</a>

      
        <div>
          <a href="#rh:wp_presentation" class="link blue underline-hover lh-copy pl3">Requests</a>
        </div>
        <ul class="list pl4">
          
          <li>
            <a href="#r:wp_presentation:destroy" class="link blue underline-hover lh-copy">destroy</a>
          </li>
          
          <li>
            <a href="#r:wp_presentation:feedback" class="link blue underline-hover lh-copy">feedback</a>
          </li>
          
        </ul>
      

      
        <div>
          <a href="#eh:wp_presentation" class="link blue underline-hover lh-copy pl3">Events</a>
        </div>
        <ul class="list pl4">
          
          <li>
            <a href="#e:wp_presentation:clock_id" class="link blue underline-hover lh-copy">clock_id</a>
          </li>
          
        </ul>
      

      
        <div>
          <a href="#enumh:wp_presentation" class="link blue underline-hover lh-copy pl3">Enums</a>
        </div>
        <ul class="list pl4">
          
          <li>
            <a href="#enum:wp_presentation:error" class="link blue underline-hover lh-copy">error</a>
          </li>
          
        </ul>
      
    </li>
  
    <li>
      <a href="#i:wp_presentation_feedback" class="link blue underline-hover lh-copy">wp_presentation_feedback</a>

      
      

      
        <div>
          <a href="#eh:wp_presentation_feedback" class="link blue underline-hover lh-copy pl3">Events</a>
        </div>
        <ul class="list pl4">
          
          <li>
            <a href="#e:wp_presentation_feedback:sync_output" class="link blue underline-hover lh-copy">sync_output</a>
          </li>
          
          <li>
            <a href="#e:wp_presentation_feedback:presented" class="link blue underline-hover lh-copy">presented</a>
          </li>
          
          <li>
            <a href="#e:wp_presentation_feedback:discarded" class="link blue underline-hover lh-copy">discarded</a>
          </li>
          
        </ul>
      

      
        <div>
          <a href="#enumh:wp_presentation_feedback" class="link blue underline-hover lh-copy pl3">Enums</a>
        </div>
        <ul class="list pl4">
          
          <li>
            <a href="#enum:wp_presentation_feedback:kind" class="link blue underline-hover lh-copy">kind</a>
          </li>
          
        </ul>
      
    </li>
  
  </ul>
</div>
  </div>

      </div>
    </div>

    <main id="content" class="mh4 w-80">
      
  <div class="ph2">
    <h1 class="f1 lh-title">presentation_time</h1>
    <ul class="list pl0">
      
      <li class="mt4">
        <h2 class="f2 lh-copy hide-child relative flex items-baseline" id="i:wp_presentation">
          <a href="#i:wp_presentation" class="link dim black-70 child pr2 absolute left--2">#</a>
          wp_presentation
        </h2>
        <div class="f6 lh-copy ws-pre-line code">
The main feature of this interface is accurate presentation
timing feedback to ensure smooth video playback while maintaining
audio&#x2f;video synchronization. Some features use the concept of a
presentation clock, which is defined in the
presentation.clock_id event.

A content update for a wl_surface is submitted by a
wl_surface.commit request. Request &#x27;feedback&#x27; associates with
the wl_surface.commit and provides feedback on the content
update, particularly the final realized presentation time.



When the final realized presentation time is available, e.g.
after a framebuffer flip completes, the requested
presentation_feedback.presented events are sent. The final
presentation time can differ from the compositor&#x27;s predicted
display update time and the update&#x27;s target time, especially
when the compositor misses its target vertical blanking period.
</div>

        
          <h3 class=" f5 lh-title" id="rh:wp_presentation">Requests</h3>
          <ul class="list pl0">
            
            <li class="mt3">
              <div class="flex items-baseline lh-title mb2 hide-child relative" id="r:wp_presentation:destroy">
                <a href="#r:wp_presentation:destroy" class="link dim black-70 child pr1 absolute left--1 hash-link-entry">#</a>
                <div class="f4">
                  destroy
                </div>
                <div class="f5 ml2">
                  unbind from the presentation interface
                </div>
              </div>
              
<div class="f6 lh-copy code">
  <span>void </span><span class="dark-blue">wp_presentation_destroy</span>(
    
      <div class="ws-pre-wrap">    <span class="purple">struct wp_presentation*</span> wp_presentation</div>
    
  )
</div>
              <div class="f6 lh-copy ws-pre-line code">Informs the server that the client will no longer be using
this protocol object. Existing objects created by this object
are not affected.
</div>
            </li>
            
            <li class="mt3">
              <div class="flex items-baseline lh-title mb2 hide-child relative" id="r:wp_presentation:feedback">
                <a href="#r:wp_presentation:feedback" class="link dim black-70 child pr1 absolute left--1 hash-link-entry">#</a>
                <div class="f4">
                  feedback
                </div>
                <div class="f5 ml2">
                  request presentation feedback information
                </div>
              </div>
              
<div class="f6 lh-copy code">
  <span>struct wp_presentation_feedback* </span><span class="dark-blue">wp_presentation_feedback</span>(
    
      <div class="ws-pre-wrap">    <span class="purple">struct wp_presentation*</span> wp_presentation,</div>
    
      <div class="ws-pre-wrap">    <span class="purple">struct wl_surface*</span> surface <span class="green">/* target surface */</span></div>
    
  )
</div>
              <div class="f6 lh-copy ws-pre-line code">Request presentation feedback for the current content submission
on the given surface. This creates a new presentation_feedback
object, which will deliver the feedback information once. If
multiple presentation_feedback objects are created for the same
submission, they will all deliver the same information.

For details on what information is returned, see the
presentation_feedback interface.
</div>
            </li>
            
          </ul>
        

        
          <h3 class=" f5 lh-title" id="eh:wp_presentation">Events</h3>
          <ul class="list pl0">
            
            <li class="mt3">
              <div class="flex items-baseline lh-title mb2 hide-child relative" id="e:wp_presentation:clock_id">
                <a href="#e:wp_presentation:clock_id" class="link dim black-70 child pr1 absolute left--1 hash-link-entry">#</a>
                <div class="f4">
                  clock_id
                </div>
                <div class="f5 ml2">
                  clock ID for timestamps
                </div>
              </div>

              
                <div class="f6 lh-copy code">
                  <span class="purple">uint32_t</span> clk_id <span class="green">/* platform clock identifier */</span> 
                </div>
              

              <div class="f6 lh-copy ws-pre-line code mt3">This event tells the client in which clock domain the
compositor interprets the timestamps used by the presentation
extension. This clock is called the presentation clock.

The compositor sends this event when the client binds to the
presentation interface. The presentation clock does not change
during the lifetime of the client connection.

The clock identifier is platform dependent. On Linux&#x2f;glibc,
the identifier value is one of the clockid_t values accepted
by clock_gettime(). clock_gettime() is defined by
POSIX.1-2001.

Timestamps in this clock domain are expressed as tv_sec_hi,
tv_sec_lo, tv_nsec triples, each component being an unsigned
32-bit value. Whole seconds are in tv_sec which is a 64-bit
value combined from tv_sec_hi and tv_sec_lo, and the
additional fractional part in tv_nsec as nanoseconds. Hence,
for valid timestamps tv_nsec must be in [0, 999999999].

Note that clock_id applies only to the presentation clock,
and implies nothing about e.g. the timestamps used in the
Wayland core protocol input events.

Compositors should prefer a clock which does not jump and is
not slewed e.g. by NTP. The absolute value of the clock is
irrelevant. Precision of one millisecond or better is
recommended. Clients must be able to query the current clock
value directly, not by asking the compositor.
</div>
            </li>
            
          </ul>

        

        
          <h3 class=" f5 lh-title" id="enumh:wp_presentation">Enums</h3>
          <ul class="list pl0">
            
            <li class="mt3">
              <div class="flex items-baseline lh-title mb2 hide-child relative" id="enum:wp_presentation:error">
                <a href="#enum:wp_presentation:error" class="link dim black-70 child pr1 absolute left--1 hash-link-entry">#</a>
                <div class="f4">
                  error
                </div>
                <div class="f5 ml2">
                  fatal presentation errors
                </div>
              </div>

              
                <div class="f6 lh-copy code">
                  WP_PRESENTATION_ERROR_INVALID_TIMESTAMP  <span class="green">/* invalid value in tv_nsec */</span> 
                </div>
              
                <div class="f6 lh-copy code">
                  WP_PRESENTATION_ERROR_INVALID_FLAG  <span class="green">/* invalid flag */</span> 
                </div>
              

              <div class="f6 lh-copy ws-pre-line code mt3">These fatal protocol errors may be emitted in response to
illegal presentation requests.
</div>
            </li>
            
          </ul>

        

      </li>
      
      <li class="mt4">
        <h2 class="f2 lh-copy hide-child relative flex items-baseline" id="i:wp_presentation_feedback">
          <a href="#i:wp_presentation_feedback" class="link dim black-70 child pr2 absolute left--2">#</a>
          wp_presentation_feedback
        </h2>
        <div class="f6 lh-copy ws-pre-line code">A presentation_feedback object returns an indication that a
wl_surface content update has become visible to the user.
One object corresponds to one content update submission
(wl_surface.commit). There are two possible outcomes: the
content update is presented to the user, and a presentation
timestamp delivered; or, the user did not see the content
update because it was superseded or its surface destroyed,
and the content update is discarded.

Once a presentation_feedback object has delivered a &#x27;presented&#x27;
or &#x27;discarded&#x27; event it is automatically destroyed.
</div>

        
        

        
          <h3 class=" f5 lh-title" id="eh:wp_presentation_feedback">Events</h3>
          <ul class="list pl0">
            
            <li class="mt3">
              <div class="flex items-baseline lh-title mb2 hide-child relative" id="e:wp_presentation_feedback:sync_output">
                <a href="#e:wp_presentation_feedback:sync_output" class="link dim black-70 child pr1 absolute left--1 hash-link-entry">#</a>
                <div class="f4">
                  sync_output
                </div>
                <div class="f5 ml2">
                  presentation synchronized to this output
                </div>
              </div>

              
                <div class="f6 lh-copy code">
                  <span class="purple">struct wl_output*</span> output <span class="green">/* presentation output */</span> 
                </div>
              

              <div class="f6 lh-copy ws-pre-line code mt3">As presentation can be synchronized to only one output at a
time, this event tells which output it was. This event is only
sent prior to the presented event.

As clients may bind to the same global wl_output multiple
times, this event is sent for each bound instance that matches
the synchronized output. If a client has not bound to the
right wl_output global at all, this event is not sent.
</div>
            </li>
            
            <li class="mt3">
              <div class="flex items-baseline lh-title mb2 hide-child relative" id="e:wp_presentation_feedback:presented">
                <a href="#e:wp_presentation_feedback:presented" class="link dim black-70 child pr1 absolute left--1 hash-link-entry">#</a>
                <div class="f4">
                  presented
                </div>
                <div class="f5 ml2">
                  the content update was displayed
                </div>
              </div>

              
                <div class="f6 lh-copy code">
                  <span class="purple">uint32_t</span> tv_sec_hi <span class="green">/* high 32 bits of the seconds part of the presentation timestamp */</span> 
                </div>
              
                <div class="f6 lh-copy code">
                  <span class="purple">uint32_t</span> tv_sec_lo <span class="green">/* low 32 bits of the seconds part of the presentation timestamp */</span> 
                </div>
              
                <div class="f6 lh-copy code">
                  <span class="purple">uint32_t</span> tv_nsec <span class="green">/* nanoseconds part of the presentation timestamp */</span> 
                </div>
              
                <div class="f6 lh-copy code">
                  <span class="purple">uint32_t</span> refresh <span class="green">/* nanoseconds till next refresh */</span> 
                </div>
              
                <div class="f6 lh-copy code">
                  <span class="purple">uint32_t</span> seq_hi <span class="green">/* high 32 bits of refresh counter */</span> 
                </div>
              
                <div class="f6 lh-copy code">
                  <span class="purple">uint32_t</span> seq_lo <span class="green">/* low 32 bits of refresh counter */</span> 
                </div>
              
                <div class="f6 lh-copy code">
                  <span class="purple">uint32_t</span> flags <span class="green">/* combination of &#x27;kind&#x27; values */</span> 
                </div>
              

              <div class="f6 lh-copy ws-pre-line code mt3">The associated content update was displayed to the user at the
indicated time (tv_sec_hi&#x2f;lo, tv_nsec). For the interpretation of
the timestamp, see presentation.clock_id event.

The timestamp corresponds to the time when the content update
turned into light the first time on the surface&#x27;s main output.
Compositors may approximate this from the framebuffer flip
completion events from the system, and the latency of the
physical display path if known.

This event is preceded by all related sync_output events
telling which output&#x27;s refresh cycle the feedback corresponds
to, i.e. the main output for the surface. Compositors are
recommended to choose the output containing the largest part
of the wl_surface, or keeping the output they previously
chose. Having a stable presentation output association helps
clients predict future output refreshes (vblank).

The &#x27;refresh&#x27; argument gives the compositor&#x27;s prediction of how
many nanoseconds after tv_sec, tv_nsec the very next output
refresh may occur. This is to further aid clients in
predicting future refreshes, i.e., estimating the timestamps
targeting the next few vblanks. If such prediction cannot
usefully be done, the argument is zero.

If the output does not have a constant refresh rate, explicit
video mode switches excluded, then the refresh argument must
be zero.

The 64-bit value combined from seq_hi and seq_lo is the value
of the output&#x27;s vertical retrace counter when the content
update was first scanned out to the display. This value must
be compatible with the definition of MSC in
GLX_OML_sync_control specification. Note, that if the display
path has a non-zero latency, the time instant specified by
this counter may differ from the timestamp&#x27;s.

If the output does not have a concept of vertical retrace or a
refresh cycle, or the output device is self-refreshing without
a way to query the refresh count, then the arguments seq_hi
and seq_lo must be zero.
</div>
            </li>
            
            <li class="mt3">
              <div class="flex items-baseline lh-title mb2 hide-child relative" id="e:wp_presentation_feedback:discarded">
                <a href="#e:wp_presentation_feedback:discarded" class="link dim black-70 child pr1 absolute left--1 hash-link-entry">#</a>
                <div class="f4">
                  discarded
                </div>
                <div class="f5 ml2">
                  the content update was not displayed
                </div>
              </div>

              

              <div class="f6 lh-copy ws-pre-line code mt3">The content update was never displayed to the user.
</div>
            </li>
            
          </ul>

        

        
          <h3 class=" f5 lh-title" id="enumh:wp_presentation_feedback">Enums</h3>
          <ul class="list pl0">
            
            <li class="mt3">
              <div class="flex items-baseline lh-title mb2 hide-child relative" id="enum:wp_presentation_feedback:kind">
                <a href="#enum:wp_presentation_feedback:kind" class="link dim black-70 child pr1 absolute left--1 hash-link-entry">#</a>
                <div class="f4">
                  kind
                </div>
                <div class="f5 ml2">
                  bitmask of flags in presented event
                </div>
              </div>

              
                <div class="f6 lh-copy code">
                  WP_PRESENTATION_FEEDBACK_KIND_VSYNC  
                </div>
              
                <div class="f6 lh-copy code">
                  WP_PRESENTATION_FEEDBACK_KIND_HW_CLOCK  
                </div>
              
                <div class="f6 lh-copy code">
                  WP_PRESENTATION_FEEDBACK_KIND_HW_COMPLETION  
                </div>
              
                <div class="f6 lh-copy code">
                  WP_PRESENTATION_FEEDBACK_KIND_ZERO_COPY  
                </div>
              

              <div class="f6 lh-copy ws-pre-line code mt3">These flags provide information about how the presentation of
the related content update was done. The intent is to help
clients assess the reliability of the feedback and the visual
quality with respect to possible tearing and timings.
</div>
            </li>
            
          </ul>

        

      </li>
      
    </ul>

    <h2 class="f4 lh-title">Copyright Info</h2>
    <div class="f7 lh-copy ws-pre-line code">Copyright © 2013-2014 Collabora, Ltd.

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the &quot;Software&quot;),
to deal in the Software without restriction, including without limitation
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and&#x2f;or sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice (including the next
paragraph) shall be included in all copies or substantial portions of the
Software.

THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL
THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.
</div>
  </div>

    </main>

  </body>
</html>